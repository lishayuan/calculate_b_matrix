1. Speed optimization for b matrix calculation in SPEN sequence
Concerning that the calculation time for SPEN sequence is proportional to the image resolution (spins at each y position has a unique b matrix to be calculated), speed optimization for SPEN sequence was also implemented in our toolkit. 
When we look more closely to the SPEN sequence, it notes that the excitation instant of all positions occurs at the plateau of the first trapezoidal gradient. Considering that the antiphase instant is the same for all y positions, it is possible to calculate the integral function of all intervals only once. Letâ€™s set the integral quantity of the first interval (i.e. the plateau stage of the first trapezoidal gradient) as an unknown quantity F0, then an expression related to F0 is used to represent the integral functions for the subsequent gradient pulses. Finally, by replacing F0 with the specific integral quantity of the first interval, and the final b-matrix of each position were calculated by accumulating the results of the corresponding intervals.